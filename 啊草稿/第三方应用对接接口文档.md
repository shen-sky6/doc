# 第三方应用对接接口文档

## 1. 接入概述

第三方应用需在后台管理系统的“管理后台”进行注册，并配置应用名称、首页 URL 等信息。注册完成后，系统管理员将分配特定的业务单位权限及相应的安全凭证。

### 1.1 登录跳转流程

当用户从管理后台点击应用菜单时，系统会重定向至第三方应用的首页，并在 URL 参数中附带身份验证令牌。

- **参数传递方式：** URL Query String
    
- **令牌有效期：** 2 小时
    
- **示例 URL：**
    
    `http://your-app-url.com/?userToken=TOKEN_VALUE&appToken=APP_VALUE`
    

---

## 2. 认证与令牌管理

### 2.1 认证服务 (获取用户信息)

用于校验令牌有效性，并获取当前登录用户的身份详情及所属机构信息。

- **请求方式：** `GET`
    
- **接口地址：** `/api/v1/authenticate`
    
- **请求头 (Headers)：**
    
    - `Authorization: Bearer {userToken}`
        
    - `X-App-Token: {appToken}`
        

#### 成功响应示例：


```json
{
  "s": 1,
  "m": "认证成功",
  "d": {
    "name": "姓名XXX",
    "userWord": "警号007XXX",
    "idNo": "身份证号500XXXXXXXXXXXXXXX",
    "unitWord": "机构编码",
    "unitName": "机构名称",
    "expireTime": "1768987878000" // 13位毫秒级时间戳
  },
  "logId": null
}
```

---

### 2.2 用户 Token 过期刷新

在 `userToken` 过期前，调用此接口获取新的令牌，以维持登录状态。

- **请求方式：** `GET`
    
- **接口地址：** `/api/v1/refreshToken`
    
- **请求头 (Headers)：**
    
    - `Authorization: Bearer {userToken}`
        
    - `X-App-Token: {appToken}`
        

#### 成功响应示例：

```JSON
{
  "s": 1,
  "m": "刷新成功",
  "d": {
    "userToken": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQi...",
    "appToken": null
  },
  "logId": null
}
```

---

## 3. 业务服务：人员落查

用于提交特定社交账号或平台 ID 的查询请求，获取关联的采集数据。

- **请求方式：** `POST`
    
- **接口地址：** `/api/v1/info_query`
    
- **请求头 (Headers)：**
    
    - `Authorization: Bearer {userToken}`
        
    - `X-App-Token: {appToken}`
        

### 3.1 请求体 (JSON)

|**参数名**|**必填**|**类型**|**说明**|
|---|---|---|---|
|`queryType`|是|String|查询类型编码（见下表）|
|`queryValue`|是|String|待查询的具体账号或 ID 值|

#### 查询类型编码表 (`queryType`)

|**编码**|**说明**|**编码**|**说明**|
|---|---|---|---|
|`QQ`|QQ 号|`KUAISHOU`|快手号|
|`WX_ID`|微信 ID|`REDNOTE`|小红书号|
|`WX_AC`|微信账号|`BDTB_ID`|百度贴吧 ID|
|`DOUYIN`|抖音号|`BAIDU_ID`|百度 ID|
|`JRTT_ID`|今日头条 ID|`BJH_USER_NAME`|百家号用户名|
|`WEIBO_ID`|微博 ID|`BILIBILI_ID`|哔哩哔哩 UID|

### 3.2 响应结果说明

成功响应将包含 `schema`（动态字段定义）和 `data`（实际业务数据）。

#### 响应示例：

```JSON
{
  "s": 1,
  "m": "查询成功",
  "d": {
    "schema": [
      { "code": "msst", "name": "时间" },
      { "code": "mdty", "name": "内容类型" },
      { "code": "sein", "name": "用户 ID" },
      { "code": "area", "name": "地区" }
    ],
    "data": [
      {
        "msst": "2025-11-18 23:50:56",
        "mdty": "10",
        "sein": "362695XXXX",
        "area": "US",
        "rcid": "0cc0e747733b97e1bb769e70dfceffea4",
        "sccjsj": "2025-11-19 00:07:25"
      }
    ]
  },
  "logId": null
}
```

---

## 4. 状态码说明

- **`s: 1`**: 操作成功。
    
- **`s: 0`**: 操作失败，具体原因见字段 `m`（如：“令牌过期”）。