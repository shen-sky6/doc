
### 指令下发逻辑

本单位指令：根据`可申领岗位`下发指令，并且将该指令消息发送给`已申领岗位`的用户

执行单位指令：根据`可申领岗位`和`权限点:eagle:gph:executionUnit` 下发指令，并且将该指令消息发送给`已申领岗位`的用户

# 研判 & 指令 —— 查看 / 执行 权限逻辑

## 1. 全部 Tab（All）

拥有权限点 **`eagle:gph:EmergencyResponseAllView`** 的用户：
- 可以查看系统内全部研判和指令信息（不受单位、岗位、执行单位限制）
- **默认不具备执行权限**
- 若用户申领了某个岗位，则仍可根据该岗位获得对应的执行权限  
    → **执行能力依旧遵循岗位逻辑，不因拥有 AllView 而自动获得**

> 即：**AllView = 全量查看；执行权限 = 仍然取决于“已申领岗位”。**

---

# 2. 其他 Tab（按用户单位 + 岗位权限控制）

## 2.1 研判信息（Judgement）

### 🔍 查看权限

用户可查看满足以下条件之一的研判信息：

- 研判的单位 = 用户所在单位
    
- 研判要求的岗位 ∈ 用户的 **可申领岗位**
    

### ⚙️ 执行权限（签收、执行、反馈等）

用户可处理满足以下条件的研判信息：

- 研判的单位 = 用户所在单位  
    **且**
    
- 研判要求的岗位 ∈ 用户的 **已申领岗位**
    

---

## 2.2 指令信息（Command）

## ⭐ 特殊规则：指令执行单位可能为 null

> 当 **executeUnit = null** 时，该指令 **不再受单位限制**，权限仅按岗位判断。

---

### 🔍 查看权限

#### 情况 A：executeUnit ≠ null

需要满足：

- 指令单位 = 用户单位  
    **且**
    
- 指令查看岗位 ∈ 用户 **已申领岗位**
    

#### 情况 B：executeUnit = null

只需满足：

- 指令查看岗位 ∈ 用户 **已申领岗位**  
    （**无需判断单位**）
    

---

### ⚙️ 执行权限（执行、反馈、审核等）

执行权限与查看权限一致：

#### 情况 A：executeUnit ≠ null

- 单位匹配
    
- 处理岗位 ∈ 用户 **已申领岗位**
    

#### 情况 B：executeUnit = null

- 处理岗位 ∈ 用户 **已申领岗位**  
    （**忽略单位**）
    

---

# 3. 权限逻辑总览（含 AllView 权限限制）

|用户情况|查看研判|执行研判|查看指令|执行指令|
|---|---|---|---|---|
|**拥有 eagle:gph:EmergencyResponseAllView**|✔ 全量|✘|✔ 全量|✘|
|普通用户（单位+可申领岗位）|✔受控|✔已申领|✔受控|✔已申领|
|指令 executeUnit = null 时|受岗位控制|受岗位控制|受岗位控制|受岗位控制|
